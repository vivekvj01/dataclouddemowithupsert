import _JSON$stringify from "@babel/runtime-corejs3/core-js-stable/json/stringify";
import _typeof from "@babel/runtime-corejs3/helpers/typeof";
import _classCallCheck from "@babel/runtime-corejs3/helpers/classCallCheck";
import _createClass from "@babel/runtime-corejs3/helpers/createClass";
import _defineProperty from "@babel/runtime-corejs3/helpers/defineProperty";
/**
 * @file Manages Salesforce Apex REST endpoint calls
 * @author Shinichi Tomita <shinichi.tomita@gmail.com>
 */
import { registerModule } from '../jsforce';
/**
 * API class for Apex REST endpoint call
 */
export var Apex = /*#__PURE__*/function () {
  /**
   *
   */
  function Apex(conn) {
    _classCallCheck(this, Apex);
    _defineProperty(this, "_conn", void 0);
    _defineProperty(this, "del", this.delete);
    this._conn = conn;
  }

  /* @private */
  _createClass(Apex, [{
    key: "_baseUrl",
    value: function _baseUrl() {
      return "".concat(this._conn.instanceUrl, "/services/apexrest");
    }
    /**
     * @private
     */
  }, {
    key: "_createRequestParams",
    value: function _createRequestParams(method, path, body) {
      var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};
      var headers = _typeof(options.headers) === 'object' ? options.headers : {};
      if (!/^(GET|DELETE)$/i.test(method)) {
        headers['content-type'] = 'application/json';
      }
      var params = {
        method: method,
        url: this._baseUrl() + path,
        headers: headers
      };
      if (body) {
        params.body = _JSON$stringify(body);
      }
      return params;
    }
    /**
     * Call Apex REST service in GET request
     */
  }, {
    key: "get",
    value: function get(path, options) {
      return this._conn.request(this._createRequestParams('GET', path, undefined, options));
    }
    /**
     * Call Apex REST service in POST request
     */
  }, {
    key: "post",
    value: function post(path, body, options) {
      var params = this._createRequestParams('POST', path, body, options);
      return this._conn.request(params);
    }
    /**
     * Call Apex REST service in PUT request
     */
  }, {
    key: "put",
    value: function put(path, body, options) {
      var params = this._createRequestParams('PUT', path, body, options);
      return this._conn.request(params);
    }
    /**
     * Call Apex REST service in PATCH request
     */
  }, {
    key: "patch",
    value: function patch(path, body, options) {
      var params = this._createRequestParams('PATCH', path, body, options);
      return this._conn.request(params);
    }
    /**
     * Call Apex REST service in DELETE request
     */
  }, {
    key: "delete",
    value: function _delete(path, options) {
      return this._conn.request(this._createRequestParams('DELETE', path, undefined, options));
    }
    /**
     * Synonym of Apex#delete()
     */
  }]);
  return Apex;
}();

/*--------------------------------------------*/
/*
 * Register hook in connection instantiation for dynamically adding this API module features
 */
registerModule('apex', function (conn) {
  return new Apex(conn);
});
export default Apex;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZWdpc3Rlck1vZHVsZSIsIkFwZXgiLCJjb25uIiwiX2NsYXNzQ2FsbENoZWNrIiwiX2RlZmluZVByb3BlcnR5IiwiZGVsZXRlIiwiX2Nvbm4iLCJfY3JlYXRlQ2xhc3MiLCJrZXkiLCJ2YWx1ZSIsIl9iYXNlVXJsIiwiY29uY2F0IiwiaW5zdGFuY2VVcmwiLCJfY3JlYXRlUmVxdWVzdFBhcmFtcyIsIm1ldGhvZCIsInBhdGgiLCJib2R5Iiwib3B0aW9ucyIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImhlYWRlcnMiLCJfdHlwZW9mIiwidGVzdCIsInBhcmFtcyIsInVybCIsIl9KU09OJHN0cmluZ2lmeSIsImdldCIsInJlcXVlc3QiLCJwb3N0IiwicHV0IiwicGF0Y2giLCJfZGVsZXRlIl0sInNvdXJjZXMiOlsiLi4vLi4vc3JjL2FwaS9hcGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGZpbGUgTWFuYWdlcyBTYWxlc2ZvcmNlIEFwZXggUkVTVCBlbmRwb2ludCBjYWxsc1xuICogQGF1dGhvciBTaGluaWNoaSBUb21pdGEgPHNoaW5pY2hpLnRvbWl0YUBnbWFpbC5jb20+XG4gKi9cbmltcG9ydCB7IHJlZ2lzdGVyTW9kdWxlIH0gZnJvbSAnLi4vanNmb3JjZSc7XG5pbXBvcnQgQ29ubmVjdGlvbiBmcm9tICcuLi9jb25uZWN0aW9uJztcbmltcG9ydCB7IEh0dHBSZXF1ZXN0LCBIdHRwTWV0aG9kcywgU2NoZW1hIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vKipcbiAqIEFQSSBjbGFzcyBmb3IgQXBleCBSRVNUIGVuZHBvaW50IGNhbGxcbiAqL1xuZXhwb3J0IGNsYXNzIEFwZXg8UyBleHRlbmRzIFNjaGVtYT4ge1xuICBfY29ubjogQ29ubmVjdGlvbjxTPjtcblxuICAvKipcbiAgICpcbiAgICovXG4gIGNvbnN0cnVjdG9yKGNvbm46IENvbm5lY3Rpb248Uz4pIHtcbiAgICB0aGlzLl9jb25uID0gY29ubjtcbiAgfVxuXG4gIC8qIEBwcml2YXRlICovXG4gIF9iYXNlVXJsKCkge1xuICAgIHJldHVybiBgJHt0aGlzLl9jb25uLmluc3RhbmNlVXJsfS9zZXJ2aWNlcy9hcGV4cmVzdGA7XG4gIH1cblxuICAvKipcbiAgICogQHByaXZhdGVcbiAgICovXG4gIF9jcmVhdGVSZXF1ZXN0UGFyYW1zKFxuICAgIG1ldGhvZDogSHR0cE1ldGhvZHMsXG4gICAgcGF0aDogc3RyaW5nLFxuICAgIGJvZHk/OiBPYmplY3QsXG4gICAgb3B0aW9uczogeyBoZWFkZXJzPzogSHR0cFJlcXVlc3RbJ2hlYWRlcnMnXSB9ID0ge30sXG4gICk6IEh0dHBSZXF1ZXN0IHtcbiAgICBjb25zdCBoZWFkZXJzOiBIdHRwUmVxdWVzdFsnaGVhZGVycyddID1cbiAgICAgIHR5cGVvZiBvcHRpb25zLmhlYWRlcnMgPT09ICdvYmplY3QnID8gb3B0aW9ucy5oZWFkZXJzIDoge307XG4gICAgaWYgKCEvXihHRVR8REVMRVRFKSQvaS50ZXN0KG1ldGhvZCkpIHtcbiAgICAgIGhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddID0gJ2FwcGxpY2F0aW9uL2pzb24nO1xuICAgIH1cbiAgICBjb25zdCBwYXJhbXM6IEh0dHBSZXF1ZXN0ID0ge1xuICAgICAgbWV0aG9kLFxuICAgICAgdXJsOiB0aGlzLl9iYXNlVXJsKCkgKyBwYXRoLFxuICAgICAgaGVhZGVycyxcbiAgICB9O1xuICAgIGlmIChib2R5KSB7XG4gICAgICBwYXJhbXMuYm9keSA9IEpTT04uc3RyaW5naWZ5KGJvZHkpO1xuICAgIH1cbiAgICByZXR1cm4gcGFyYW1zO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGwgQXBleCBSRVNUIHNlcnZpY2UgaW4gR0VUIHJlcXVlc3RcbiAgICovXG4gIGdldDxSID0gdW5rbm93bj4ocGF0aDogc3RyaW5nLCBvcHRpb25zPzogT2JqZWN0KSB7XG4gICAgcmV0dXJuIHRoaXMuX2Nvbm4ucmVxdWVzdDxSPihcbiAgICAgIHRoaXMuX2NyZWF0ZVJlcXVlc3RQYXJhbXMoJ0dFVCcsIHBhdGgsIHVuZGVmaW5lZCwgb3B0aW9ucyksXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsIEFwZXggUkVTVCBzZXJ2aWNlIGluIFBPU1QgcmVxdWVzdFxuICAgKi9cbiAgcG9zdDxSID0gdW5rbm93bj4ocGF0aDogc3RyaW5nLCBib2R5PzogT2JqZWN0LCBvcHRpb25zPzogT2JqZWN0KSB7XG4gICAgY29uc3QgcGFyYW1zID0gdGhpcy5fY3JlYXRlUmVxdWVzdFBhcmFtcygnUE9TVCcsIHBhdGgsIGJvZHksIG9wdGlvbnMpO1xuICAgIHJldHVybiB0aGlzLl9jb25uLnJlcXVlc3Q8Uj4ocGFyYW1zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsIEFwZXggUkVTVCBzZXJ2aWNlIGluIFBVVCByZXF1ZXN0XG4gICAqL1xuICBwdXQ8UiA9IHVua25vd24+KHBhdGg6IHN0cmluZywgYm9keT86IE9iamVjdCwgb3B0aW9ucz86IE9iamVjdCkge1xuICAgIGNvbnN0IHBhcmFtcyA9IHRoaXMuX2NyZWF0ZVJlcXVlc3RQYXJhbXMoJ1BVVCcsIHBhdGgsIGJvZHksIG9wdGlvbnMpO1xuICAgIHJldHVybiB0aGlzLl9jb25uLnJlcXVlc3Q8Uj4ocGFyYW1zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsIEFwZXggUkVTVCBzZXJ2aWNlIGluIFBBVENIIHJlcXVlc3RcbiAgICovXG4gIHBhdGNoPFIgPSB1bmtub3duPihwYXRoOiBzdHJpbmcsIGJvZHk/OiBPYmplY3QsIG9wdGlvbnM/OiBPYmplY3QpIHtcbiAgICBjb25zdCBwYXJhbXMgPSB0aGlzLl9jcmVhdGVSZXF1ZXN0UGFyYW1zKCdQQVRDSCcsIHBhdGgsIGJvZHksIG9wdGlvbnMpO1xuICAgIHJldHVybiB0aGlzLl9jb25uLnJlcXVlc3Q8Uj4ocGFyYW1zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsIEFwZXggUkVTVCBzZXJ2aWNlIGluIERFTEVURSByZXF1ZXN0XG4gICAqL1xuICBkZWxldGU8UiA9IHVua25vd24+KHBhdGg6IHN0cmluZywgb3B0aW9ucz86IE9iamVjdCkge1xuICAgIHJldHVybiB0aGlzLl9jb25uLnJlcXVlc3Q8Uj4oXG4gICAgICB0aGlzLl9jcmVhdGVSZXF1ZXN0UGFyYW1zKCdERUxFVEUnLCBwYXRoLCB1bmRlZmluZWQsIG9wdGlvbnMpLFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogU3lub255bSBvZiBBcGV4I2RlbGV0ZSgpXG4gICAqL1xuICBkZWwgPSB0aGlzLmRlbGV0ZTtcbn1cblxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4vKlxuICogUmVnaXN0ZXIgaG9vayBpbiBjb25uZWN0aW9uIGluc3RhbnRpYXRpb24gZm9yIGR5bmFtaWNhbGx5IGFkZGluZyB0aGlzIEFQSSBtb2R1bGUgZmVhdHVyZXNcbiAqL1xucmVnaXN0ZXJNb2R1bGUoJ2FwZXgnLCAoY29ubikgPT4gbmV3IEFwZXgoY29ubikpO1xuXG5leHBvcnQgZGVmYXVsdCBBcGV4O1xuIl0sIm1hcHBpbmdzIjoiOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBU0EsY0FBYyxRQUFRLFlBQVk7QUFJM0M7QUFDQTtBQUNBO0FBQ0EsV0FBYUMsSUFBSTtFQUdmO0FBQ0Y7QUFDQTtFQUNFLFNBQUFBLEtBQVlDLElBQW1CLEVBQUU7SUFBQUMsZUFBQSxPQUFBRixJQUFBO0lBQUFHLGVBQUE7SUFBQUEsZUFBQSxjQStFM0IsSUFBSSxDQUFDQyxNQUFNO0lBOUVmLElBQUksQ0FBQ0MsS0FBSyxHQUFHSixJQUFJO0VBQ25COztFQUVBO0VBQUFLLFlBQUEsQ0FBQU4sSUFBQTtJQUFBTyxHQUFBO0lBQUFDLEtBQUEsV0FBQUMsU0FBQSxFQUNXO01BQ1QsVUFBQUMsTUFBQSxDQUFVLElBQUksQ0FBQ0wsS0FBSyxDQUFDTSxXQUFXO0lBQ2xDO0lBRUE7QUFDRjtBQUNBO0VBRkU7SUFBQUosR0FBQTtJQUFBQyxLQUFBLFdBQUFJLHFCQUlFQyxNQUFtQixFQUNuQkMsSUFBWSxFQUNaQyxJQUFhLEVB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